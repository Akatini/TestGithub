# Git 学习笔记

## 一、Git 基础概念

### 1.1 什么是 Git

Git 是一个开源的分布式版本控制系统，它可以有效、高速地处理从很小到非常大的项目版本管理。与集中式版本控制系统不同，Git 不需要中央服务器来存储代码，每个开发者的电脑上都有一个完整的版本库，这样即使在没有网络的情况下，也可以进行代码的提交、查看历史等操作。

### 1.2 工作区、暂存区和版本库

- **工作区**：就是你在电脑里能看到的目录，比如你创建的项目文件夹，在这个文件夹里进行代码的编写、修改等操作。

- **暂存区**：英文叫 stage 或 index，它是一个临时的存储区域，位于.git 目录下的 index 文件中。当你对工作区的文件进行修改后，需要通过git add命令将修改的文件添加到暂存区，暂存区的作用是暂时保存你的修改，方便你后续一次性提交到版本库。

- **版本库**：也叫仓库（repository），工作区有一个隐藏目录.git，这个就是 Git 的版本库。版本库中包含了所有的版本信息、分支信息等，是 Git 管理项目的核心。

### 1.3 仓库管理

#### 1.3.1 集中式版本控制系统（以 SVN 为例）

集中式版本控制系统的核心是一个中央服务器，所有的版本信息都存储在中央服务器中，开发者的电脑上只保存当前工作的版本。

![截图_20250716225945](E:\Study\CodeProgram\Git\test\TestGithub\assets\截图_20250716225945.png)

##### 工作原理

- 开发者在开始工作前，需要从中央服务器上 checkout（检出）最新的代码到本地电脑，形成一个工作副本。

- 在本地进行代码修改后，需要将修改通过 commit（提交）操作上传到中央服务器，中央服务器会将这些修改整合到版本库中，并生成新的版本号。

- 其他开发者要获取最新的代码时，需要从中央服务器上 update（更新）代码到本地。

##### 特点

- 中央服务器是整个系统的核心，一旦中央服务器出现故障，开发者就无法进行代码的提交、更新等操作，甚至可能导致数据丢失（如果没有备份）。

- 所有操作都需要与中央服务器进行交互，对网络的依赖性较强，在网络不稳定或没有网络的情况下，很多操作无法完成。

- 存储的是版本之间的差异，每次提交只需要上传修改的部分，节省网络带宽。

#### 1.3.2 分布式版本控制系统（以 Git 为例）

分布式版本控制系统没有中央服务器的概念，每个开发者的电脑上都有一个完整的版本库，包含了项目所有的历史版本信息。

![截图_20250716230839](E:\Study\CodeProgram\Git\test\TestGithub\assets\截图_20250716230839.png)

##### 工作原理

- 开发者可以从一个已有的远程版本库（如 GitHub、GitLab 上的仓库）clone（克隆）代码到本地，此时本地会形成一个完整的版本库，包含所有的历史记录。

- 在本地进行代码开发时，可以随时进行 commit 操作，将修改提交到本地版本库，生成新的版本，这些操作不需要网络连接。

- 当需要与其他开发者共享代码时，可以将本地的修改 push（推送）到远程版本库，其他开发者可以从远程版本库 pull（拉取）这些修改到自己的本地版本库。

##### 特点

- 每个本地版本库都是独立完整的，即使远程版本库出现问题，开发者依然可以在本地进行代码的提交、查看历史等操作，对网络的依赖性较低。

- 支持离线工作，在没有网络的环境下，开发者可以正常进行代码的开发和版本管理，待网络恢复后再与远程版本库同步。

- 存储的是完整的文件快照，而不是版本之间的差异，虽然初始克隆时需要下载更多的数据，但后续的操作速度更快，因为不需要频繁与远程服务器交互计算差异。

- 分支操作非常灵活、高效，创建和合并分支的成本很低，便于团队进行并行开发。

#### 1.3.3 集中式与分布式的主要区别

| 对比维度   | 集中式版本控制系统（SVN）                      | 分布式版本控制系统（Git）                    |
| ---------- | ---------------------------------------------- | -------------------------------------------- |
| 版本库存储 | 版本库集中存储在中央服务器，本地只有工作副本   | 每个本地都有完整的版本库，远程版本库用于共享 |
| 网络依赖   | 大部分操作需要网络连接，依赖中央服务器         | 本地操作无需网络，仅同步时需要网络           |
| 容错性     | 中央服务器故障会影响所有开发者工作，数据易丢失 | 单个节点故障不影响其他节点，数据安全性高     |
| 分支管理   | 分支操作相对复杂，成本较高                     | 分支操作简单、高效，支持多种分支策略         |
| 数据存储   | 存储版本间的差异                               | 存储文件的完整快照                           |

## 二、Git 配置

安装完成后，需要进行一些基本配置，主要是设置用户名和邮箱，这些信息会出现在你的提交记录中。

- 设置用户名：git config --global user.name "你的用户名"

- 设置邮箱：git config --global user.email "你的邮箱地址"

可以使用git config --list命令查看当前的配置信息。

### 1、windows

ssh-keygen -t rsa -C "注册账号的邮箱名字"

所有的请求输入全部回车带过

自动生成了SSH通信用的公私密钥

打开公钥id_rsa.pub，拷贝文件内容

github中setting设置此密钥

此客户端可以根据此ssh来访问github仓库。

最后验证是否链接到github，ssh -T git@github.com

### 2.Ubuntu

ssh-keygen -t rsa -C "注册账号的邮箱名字"

找到公钥位置cd /home/user/.ssh/

cat id_rsa.pub得到公钥后，拷贝文件内容到github上注册

## 三、Git 核心操作

### 3.1 Git克隆

![截图_20250805183726](E:\Study\CodeProgram\Git\test\TestGithub\assets\截图_20250805183726.png)

克隆一个仓库到本地，使用ls可以看到仓库内部的文件

git clone git@github.com:User/Project.git 

### 3.2 添加文件到暂存区

| 代码             | 作用                                                         |
| ---------------- | ------------------------------------------------------------ |
| git add 文件名   | 将指定文件添加到暂存区。例如git add index.html，可将 index.html 文件添加到暂存区。 |
| git add 目录名   | 将指定目录下的所有文件添加到暂存区。比如git add src/，会把 src 目录里的所有文件添加进去。 |
| git add .        | 将当前目录下所有修改的文件添加到暂存区，但会忽略被.gitignore 文件排除的文件。 |
| git add -A       | 添加所有变化的文件到暂存区，包括新增、修改、删除的文件，不受当前目录限制。 |
| git add --all    | 同上                                                         |
| git add -u       | 只添加已经跟踪过的文件（即之前已被提交到版本库的文件）的修改和删除操作到暂存区，不包括新增文件。 |
| git add --update | 同上                                                         |

### 3.3 提交文件到版本库

<img src="E:\Study\CodeProgram\Git\test\TestGithub\assets\截图_20250805185018.png" alt="截图_20250805185018" style="zoom:50%;" />

使用git commit -m "提交说明"命令将暂存区的文件提交到版本库，提交说明要简洁明了地描述本次提交的内容。



### 3.4 查看工作区状态

git status命令可以查看工作区和暂存区的状态，比如哪些文件被修改了但还没添加到暂存区，哪些文件已经添加到暂存区但还没提交到版本库等。

### 3.5 查看提交历史

- git log：查看详细的提交历史，包括提交人、提交时间、提交说明等信息。

- git log --pretty=oneline：以简洁的方式显示提交历史，只显示提交的哈希值和提交说明。

### 3.6 版本回退

- git reset --hard HEAD^：回退到上一个版本，HEAD^^表示回退到上上个版本，以此类推。

- git reset --hard 提交哈希值：回退到指定的版本，提交哈希值可以通过git log命令查看。

如果回退后又想回到之前的新版本，可以使用git reflog命令查看所有的操作记录，找到想要回到的版本的哈希值，然后使用git reset --hard 哈希值命令进行回退。

### 3.7 撤销修改

- 如果文件在工作区被修改了，但还没添加到暂存区，可以使用git checkout -- 文件名命令撤销修改，恢复到最近一次提交或添加到暂存区时的状态。

- 如果文件已经添加到暂存区，又做了修改，可以先使用git reset HEAD 文件名命令将文件从暂存区撤回到工作区，然后再使用git checkout -- 文件名命令撤销工作区的修改。

### 3.8 删除文件

- 如果在工作区删除了文件，可以使用git rm 文件名命令将删除操作添加到暂存区，然后使用git commit -m "删除说明"命令提交到版本库。

- 如果误删了文件，可以使用git checkout -- 文件名命令从版本库中恢复文件。

## 四、Git 分支管理

### 4.1 什么是分支

分支就像是项目开发中的一条并行的时间线，默认情况下，Git 会创建一个名为master的主分支。在开发过程中，我们可以创建新的分支来进行功能开发、bug 修复等操作，避免影响主分支的代码。

### 4.2 查看分支

git branch命令可以查看当前所有的分支，当前所在的分支会以*标记。

### 4.3 创建分支

git branch 分支名命令可以创建一个新的分支。

### 4.4 切换分支

git checkout 分支名命令可以切换到指定的分支，也可以使用git switch 分支名命令（Git 2.23 + 版本新增）。

### 4.5 创建并切换分支

git checkout -b 分支名或git switch -c 分支名命令可以创建一个新的分支并立即切换到该分支。

### 4.6 合并分支

git merge 分支名命令可以将指定分支的代码合并到当前分支，合并时可能会出现冲突，需要手动解决冲突后再提交。

### 4.7 删除分支

- git branch -d 分支名：删除指定的分支，只能删除已经合并到主分支的分支。

- git branch -D 分支名：强制删除指定的分支，即使该分支的代码没有合并到主分支。

## 五、Git 远程仓库

### 5.1 关联远程仓库

git remote add origin 远程仓库地址命令可以将本地仓库与远程仓库关联起来，其中origin是远程仓库的别名，可以自定义。

### 5.2 从远程仓库克隆

git clone 远程仓库地址命令可以将远程仓库克隆到本地，克隆后会在本地生成一个与远程仓库同名的目录，该目录中包含了完整的版本库。

### 5.3 推送到远程仓库

``git push origin 本地分支名:远程分支名`` 命令可以将本地分支的代码推送到远程仓库的指定分支，第一次推送时需要加上-u参数，以后推送可以直接使用git push命令。

### 5.4 从远程仓库拉取

- git pull origin 分支名命令可以从远程仓库的指定分支拉取代码到本地当前分支，如果本地分支与远程分支有关联，可以直接使用git pull命令。

- 在拉取代码前，最好先提交本地的修改，或者使用git stash命令将本地修改暂存起来，拉取完成后再使用git stash pop命令恢复暂存的修改。

## 六、Git 常见问题及解决方法

### 6.1 合并冲突

当合并分支时出现冲突，Git 会在冲突的文件中标记出冲突的内容，需要手动打开文件，修改冲突部分，然后使用git add命令添加到暂存区，再使用git commit命令提交。

### 6.2 忘记提交说明

如果在提交时忘记填写提交说明，可以使用git commit --amend命令重新编辑提交说明。

### 6.3 撤销已经推送的提交

如果已经将错误的提交推送到了远程仓库，需要撤销该提交，可以使用git revert 提交哈希值命令，该命令会创建一个新的提交来抵消之前的提交，而不是删除之前的提交记录，这样可以保证远程仓库的历史记录的完整性。
